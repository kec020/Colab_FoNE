2025-08-21 22:15:01 - INFO - result/train_from_scratch/Qwen/Qwen2.5-7B-Instruct/1000addition/fne/period_base_list_[10.0]_batchsize_32_epochs_5_lr_5e-05_int_digit_len_5_frac_digit_len_5_seed42_num_train_samples_None_model_size_level_4_lengensize_0_addlinear_True
2025-08-21 22:15:01 - INFO - Namespace(batch_size=32, epochs=5, int_digit_len=5, frac_digit_len=5, len_gen_size=0, lr=5e-05, name='', model='Qwen/Qwen2.5-7B-Instruct', dataset='Onlydrinkwater/1000addition', train_from_scratch=True, use_digit_wise_tokenizer=False, num_train_samples=None, num_test_samples=None, seed=42, model_size_level=4, method='fne', scheduler_name='cosine', period_base_list=[10.0], clip=False, not_add_linear=False, use_lora=False, add_linear=True)
2025-08-21 22:15:01 - INFO - Dataset specified as single name: Onlydrinkwater/1000addition
2025-08-21 22:15:04 - INFO - Model initialized from scratch with size level: 4
2025-08-21 22:15:05 - INFO - Standard tokenizer loaded.
2025-08-21 22:15:05 - INFO - Expanded tokenizer by 397 dummy tokens to match model vocab_size=152064.
2025-08-21 22:15:05 - INFO - Actual model size (total parameters): 81.79M
2025-08-21 22:15:05 - INFO - Padding token ID: 151665
2025-08-21 22:15:05 - INFO - [NUM] token ID: 151666
2025-08-21 22:15:05 - INFO - Train dataset length: 72000, Test dataset length: 20000
2025-08-21 22:15:19 - INFO - 2 data example: [{'input_ids': tensor([   220, 151666,    220,    488,    256, 151666,    220,    284,    220]), 'numbers': [678.0, 764.0], 'label': 1442.0}, {'input_ids': tensor([   220, 151666,    220,    488,    256, 151666,    220,    284,    220]), 'numbers': [365.0, 950.0], 'label': 1315.0}]
2025-08-21 22:15:19 - INFO - period_list: [0.0001, 0.001, 0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0, 100000.0]
2025-08-21 22:15:19 - INFO - self.powers_of_ten: tensor([         1,         10,        100,       1000,      10000,     100000,
           1000000,   10000000,  100000000, 1000000000], device='cuda:0')
2025-08-21 22:15:19 - INFO - ----------------------------------------------------------------------------------------------------
2025-08-21 22:15:19 - INFO - Starting Epoch 1/5
2025-08-21 22:16:16 - INFO - avg Loss: 1.232164162238439
2025-08-21 22:16:16 - INFO - Evaluation start
2025-08-21 22:16:35 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:16:35 - INFO - Predicted: 678.0, Actual: 668.0
2025-08-21 22:16:35 - INFO - Predicted: 465.0, Actual: 455.0
2025-08-21 22:16:35 - INFO - Predicted: 1450.0, Actual: 1460.0
2025-08-21 22:16:35 - INFO - Predicted: 797.0, Actual: 787.0
2025-08-21 22:16:35 - INFO - Predicted: 690.0, Actual: 700.0
2025-08-21 22:16:35 - INFO - Epoch                                   1         
2025-08-21 22:16:35 - INFO - Train Loss                              1.2322
2025-08-21 22:16:35 - INFO - Test Loss                               0.7045
2025-08-21 22:16:35 - INFO - Whole Num Acc                           64.110000%
2025-08-21 22:16:35 - INFO - Digit-wise Acc                          90.116068%
2025-08-21 22:16:35 - INFO - MSE                                     34909.006400
2025-08-21 22:16:35 - INFO - R^2                                     0.788607616882731
2025-08-21 22:16:35 - INFO - Learning Rate                           0.000050
2025-08-21 22:16:35 - INFO - ----------------------------------------------------------------------------------------------------
2025-08-21 22:16:35 - INFO - Starting Epoch 2/5
2025-08-21 22:17:59 - INFO - avg Loss: 0.6618934620221456
2025-08-21 22:17:59 - INFO - Evaluation start
2025-08-21 22:18:17 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:18:17 - INFO - Predicted: 1460.0, Actual: 1470.0
2025-08-21 22:18:17 - INFO - Predicted: 601.0, Actual: 701.0
2025-08-21 22:18:17 - INFO - Predicted: 1450.0, Actual: 1460.0
2025-08-21 22:18:17 - INFO - Predicted: 790.0, Actual: 700.0
2025-08-21 22:18:17 - INFO - Predicted: 100.0, Actual: 200.0
2025-08-21 22:18:17 - INFO - Epoch                                   2         
2025-08-21 22:18:17 - INFO - Train Loss                              0.6619
2025-08-21 22:18:17 - INFO - Test Loss                               0.6485
2025-08-21 22:18:17 - INFO - Whole Num Acc                           79.975000%
2025-08-21 22:18:17 - INFO - Digit-wise Acc                          94.932506%
2025-08-21 22:18:17 - INFO - MSE                                     21448.809950
2025-08-21 22:18:17 - INFO - R^2                                     0.870116181526155
2025-08-21 22:18:17 - INFO - Learning Rate                           0.000043
2025-08-21 22:18:17 - INFO - ----------------------------------------------------------------------------------------------------
2025-08-21 22:18:17 - INFO - Starting Epoch 3/5
2025-08-21 22:19:41 - INFO - avg Loss: 0.6437499710453881
2025-08-21 22:19:41 - INFO - Evaluation start
2025-08-21 22:20:00 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:20:00 - INFO - Predicted: 887.0, Actual: 787.0
2025-08-21 22:20:00 - INFO - Predicted: 1210.0, Actual: 1220.0
2025-08-21 22:20:00 - INFO - Predicted: 1296.0, Actual: 1196.0
2025-08-21 22:20:00 - INFO - Predicted: 879.0, Actual: 869.0
2025-08-21 22:20:00 - INFO - Predicted: 1206.0, Actual: 1306.0
2025-08-21 22:20:00 - INFO - Epoch                                   3         
2025-08-21 22:20:00 - INFO - Train Loss                              0.6437
2025-08-21 22:20:00 - INFO - Test Loss                               0.6418
2025-08-21 22:20:00 - INFO - Whole Num Acc                           87.600000%
2025-08-21 22:20:00 - INFO - Digit-wise Acc                          96.909111%
2025-08-21 22:20:00 - INFO - MSE                                     10045.237450
2025-08-21 22:20:00 - INFO - R^2                                     0.939170807120585
2025-08-21 22:20:00 - INFO - Learning Rate                           0.000025
2025-08-21 22:20:00 - INFO - ----------------------------------------------------------------------------------------------------
2025-08-21 22:20:00 - INFO - Starting Epoch 4/5
2025-08-21 22:21:24 - INFO - avg Loss: 0.6408310094674429
2025-08-21 22:21:24 - INFO - Evaluation start
2025-08-21 22:21:42 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:21:42 - INFO - Predicted: 1460.0, Actual: 1470.0
2025-08-21 22:21:42 - INFO - Predicted: 887.0, Actual: 787.0
2025-08-21 22:21:42 - INFO - Predicted: 1296.0, Actual: 1196.0
2025-08-21 22:21:42 - INFO - Predicted: 1206.0, Actual: 1306.0
2025-08-21 22:21:42 - INFO - Predicted: 1129.0, Actual: 1119.0
2025-08-21 22:21:42 - INFO - Epoch                                   4         
2025-08-21 22:21:42 - INFO - Train Loss                              0.6408
2025-08-21 22:21:42 - INFO - Test Loss                               0.6408
2025-08-21 22:21:42 - INFO - Whole Num Acc                           89.640000%
2025-08-21 22:21:42 - INFO - Digit-wise Acc                          97.504912%
2025-08-21 22:21:42 - INFO - MSE                                     7677.168950
2025-08-21 22:21:42 - INFO - R^2                                     0.953510706625715
2025-08-21 22:21:42 - INFO - Learning Rate                           0.000007
2025-08-21 22:21:42 - INFO - ----------------------------------------------------------------------------------------------------
2025-08-21 22:21:42 - INFO - Starting Epoch 5/5
2025-08-21 22:23:07 - INFO - avg Loss: 0.640324538257387
2025-08-21 22:23:07 - INFO - Evaluation start
2025-08-21 22:23:25 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:23:25 - INFO - Predicted: 1460.0, Actual: 1470.0
2025-08-21 22:23:25 - INFO - Predicted: 887.0, Actual: 787.0
2025-08-21 22:23:25 - INFO - Predicted: 1296.0, Actual: 1196.0
2025-08-21 22:23:25 - INFO - Predicted: 1206.0, Actual: 1306.0
2025-08-21 22:23:25 - INFO - Predicted: 1129.0, Actual: 1119.0
2025-08-21 22:23:25 - INFO - Epoch                                   5         
2025-08-21 22:23:25 - INFO - Train Loss                              0.6403
2025-08-21 22:23:25 - INFO - Test Loss                               0.6408
2025-08-21 22:23:25 - INFO - Whole Num Acc                           89.840000%
2025-08-21 22:23:25 - INFO - Digit-wise Acc                          97.524014%
2025-08-21 22:23:25 - INFO - MSE                                     8149.011450
2025-08-21 22:23:25 - INFO - R^2                                     0.950653452271692
2025-08-21 22:23:25 - INFO - Learning Rate                           0.000000
2025-08-21 22:23:25 - INFO - Starting Final evaluation.
2025-08-21 22:23:25 - INFO - Evaluation start
2025-08-21 22:23:43 - INFO - Mispredictions (up to 5 examples):
2025-08-21 22:23:43 - INFO - Predicted: 1460.0, Actual: 1470.0
2025-08-21 22:23:43 - INFO - Predicted: 887.0, Actual: 787.0
2025-08-21 22:23:43 - INFO - Predicted: 1296.0, Actual: 1196.0
2025-08-21 22:23:43 - INFO - Predicted: 1206.0, Actual: 1306.0
2025-08-21 22:23:43 - INFO - Predicted: 1129.0, Actual: 1119.0
2025-08-21 22:23:43 - INFO - Final Test Results:
2025-08-21 22:23:43 - INFO - Test Loss                               0.6408
2025-08-21 22:23:43 - INFO - Whole Num Accuracy                      89.840000%
2025-08-21 22:23:43 - INFO - Digit-wise Accuracy                     97.524014%
2025-08-21 22:23:43 - INFO - MSE                                     8149.011450
2025-08-21 22:23:43 - INFO - R^2                                     0.950653452271692
